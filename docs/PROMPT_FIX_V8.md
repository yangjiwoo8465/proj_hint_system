# 프롬프트 수정 V8 - 개념 질문 완전 차단 (상황 중심)

## 문제 상황 (V7 → V8)

### V7에서 발생한 문제

**생성된 힌트:**
```
함수 정의를 이해하고 사용하기 위한 과정에서 중요한 단계 중 하나가 무엇일까요
```

**문제:**
- "함수 정의를 이해하고" → 교육적/개념적 질문
- "중요한 단계 중 하나" → 추상적인 학습 질문
- 사용자 코드의 **구체적 문제 상황**을 제시하지 않음
- 소크라테스 학습법 아님 → 단순 개념 질문

### 사용자의 진짜 요구사항

**사용자 피드백:**
> "힌트는 해당 문제의 해답 코드를 N개의 Logic으로 분할한 후,
> - 사용자가 M번째 Logic을 틀릴 경우 → 해당 M번째 Logic을 풀어낼 수 있는 형태
> - 사용자가 M번째까지 완벽하고 M+1번째를 모르는 경우 → M+1번째 Logic을 떠올릴 수 있는 형태
> - 답을 알려주는 게 아니라 소크라테스 학습법으로 사용자가 직접 생각할 수 있도록"

**핵심:**
1. **Logic Step 기반** - 학생이 지금 어느 단계에 있는지
2. **구체적 상황** - 지금 코드로는 무엇이 안 되는지
3. **소크라테스식** - 불편한 상황 제시 → 스스로 해결책 발견

---

## 핵심 수정 사항

### V7 프롬프트 (Before) - 여전히 추상적 가능

```python
임무: 학생이 "{next_step_goal}"의 필요성을 스스로 깨닫게 만드는 질문을 한국어 반말로 작성하세요.

절대 금지:
- 함수명, 변수명, 코드 문법 언급
- 백틱, 코드 사용
- 영어 사용
- 설명, 정답, 추가 정보

질문 작성 원칙:
1. 구체적 상황: "큰 규모"(X) → "10개", "100번", "1000개"(O)
2. 현실적 불편: 추상적 질문(X) → 직접 겪을 불편함(O)
3. 학생 관점: "어떻게 하면 좋을까?"(X) → "너는 어떻게 할 건데?"(O)
```

**문제점:**
- "필요성을 깨닫게" → 여전히 교육적 접근 가능
- **개념 질문을 명시적으로 차단하지 않음**
- "함수가 뭐야?", "중요한 단계가 뭘까?" 같은 질문 생성 가능

---

### V8 프롬프트 (After) - 개념 질문 명시적 차단

```python
임무: 학생이 지금 코드로는 "{next_step_goal}"를 할 수 없다는 걸 깨닫게 만드는 질문을 한국어 반말로 작성하세요.

절대 금지:
- "함수가 뭐야?", "반복문이 뭐야?" 같은 개념 질문 금지
- "중요한 단계", "핵심 개념", "이해하기" 같은 교육적 표현 금지
- 함수명, 변수명, 코드 문법(def, for, if) 언급 금지
- 영어, 백틱, 설명, 정답 금지

질문 작성 원칙:
1. 현재 코드 기준: 학생이 지금 작성한 코드로는 무엇이 불가능한지
2. 구체적 숫자: "많이", "크게" 금지 → "10개", "100번", "1000개" 사용
3. 직접적 불편: "어떻게 하면 좋을까?" 금지 → "너는 어떻게 할 건데?" 사용

나쁜 질문 (교육적, 개념적):
- "함수 정의를 이해하는 중요한 단계가 뭘까?" (교육적)
- "효율적인 방법이 있을까?" (추상적)
- "어떤 개념이 필요할까?" (개념 질문)

좋은 질문 (상황적, 구체적):
- "같은 계산을 10군데에서 해야 하는데 코드 10번 복사할 건가?" (상황)
- "나중에 계산 방법 바꾸면 10군데를 다 찾아서 수정해?" (불편)
- "이 작업을 다른 문제에서도 쓰려면 매번 복사 붙여넣기?" (현실)
```

**개선 사항:**
1. **명시적 개념 질문 차단** - "함수가 뭐야?", "반복문이 뭐야?" 직접 예시
2. **교육적 표현 차단** - "중요한 단계", "핵심 개념", "이해하기" 금지
3. **프레임 변경** - "필요성 깨닫게" → "지금 코드로는 할 수 없다는 걸 깨닫게"
4. **나쁜 질문 예시 추가** - 교육적/개념적 질문의 구체적 예시
5. **좋은 질문 예시 강화** - 상황, 불편, 현실로 분류

---

## 왜 V8이 필요했나?

### V7의 한계

**V7은 "구체적 숫자"에만 집중:**
- "큰 규모" → "10개, 100번" (구체화 성공)
- 하지만 **질문의 성격** 자체는 제어 못함
- 결과: "함수 정의를 이해하는 중요한 단계..." (개념 질문)

**V7이 막지 못한 것:**
- ❌ "함수가 뭐야?"
- ❌ "중요한 단계가 뭘까?"
- ❌ "이해하기 위해 뭐가 필요해?"

### V8의 핵심 전략

**3단계 차단:**
1. **명시적 금지** - "함수가 뭐야?" 같은 개념 질문 직접 예시
2. **교육적 표현 리스트** - "중요한 단계", "핵심 개념", "이해하기"
3. **대조 예시** - 나쁜 질문 vs 좋은 질문

**프레임 전환:**
- Before: "필요성을 깨닫게" → 추상적, 교육적 접근 가능
- After: "지금 코드로는 할 수 없다는 걸 깨닫게" → 현재 코드의 한계 강조

---

## V7 vs V8 비교

### 같은 점
- 구체적 숫자 사용 ("10개", "100번")
- 대조 방식 (나쁜 것 vs 좋은 것)
- 백틱, 함수명 언급 금지

### 다른 점

| 항목 | V7 | V8 |
|------|----|----|
| **프레임** | "필요성 깨닫게" | "지금 코드로는 할 수 없다는 걸 깨닫게" |
| **개념 질문 차단** | 암시적 (없음) | 명시적 ("함수가 뭐야?" 예시) |
| **교육적 표현** | 언급 없음 | 명시적 금지 리스트 |
| **나쁜 질문 예시** | 막연한 것만 | 교육적/개념적 질문 포함 |
| **좋은 질문 설명** | (상황) 태그만 | (상황), (불편), (현실) 상세 분류 |

---

## 기대 효과

### Before (V7):
```
함수 정의를 이해하고 사용하기 위한 과정에서 중요한 단계 중 하나가 무엇일까요
```
→ 교육적, 개념적, 추상적

### After (V8 예상):
```
같은 검사를 10군데에서 해야 하는데 코드 10번 복사할 건가?
나중에 검사 조건 바꾸면 10군데를 다 찾아서 수정해?
이 검사를 다른 문제에서도 쓰려면 매번 복사 붙여넣기?
```
→ 상황적, 구체적, 불편함 중심

---

## 소크라테스 학습법 재정의 (V8 기준)

### ❌ 소크라테스가 아닌 것

**개념 질문:**
- "함수가 뭐야?"
- "반복문이 뭐야?"
- "효율적인 방법이 있을까?"

**교육적 질문:**
- "중요한 단계가 뭘까?"
- "핵심 개념을 이해했어?"
- "어떤 원리를 적용해야 할까?"

### ✅ 소크라테스의 진짜 의미 (V8)

**1. 현재 코드 기준**
- "지금 네 코드로는 10개 처리 못하는데?"

**2. 구체적 상황**
- "100번 계산해야 하면 코드 100번 쓸 건가?"

**3. 직접적 불편**
- "나중에 수정하려면 모든 줄 찾아서 바꿀 건데?"

**핵심:** 학생이 **불편한 상황**을 직접 겪으면서 **스스로 해결책** 발견

---

## Logic Step과의 연결

### 사용자가 원하는 힌트 시스템

**상황 1: M번째 Logic을 틀린 경우**
- 지금 코드 → M번째 Logic 실패 상황 구체화
- "이렇게 하면 어떻게 되는데?" → 틀린 이유 깨닫게

**상황 2: M번째까지 완벽, M+1번째 모름**
- 지금 코드 → M+1번째 필요한 상황 구체화
- "10개 처리해야 하는데?" → M+1번째 Logic 필요성 깨닫게

**V8 프롬프트가 어떻게 지원:**
- `next_step_goal` = M+1번째 Logic
- "지금 코드로는 {next_step_goal}를 할 수 없다는 걸 깨닫게"
- 구체적 숫자로 상황 제시 → 불편함 느낌 → 스스로 해결책 찾기

---

## 변경 위치

**파일:** [hint-system/app.py](../hint-system/app.py#L322-L354)
**함수:** `_create_analysis_prompt()`
**라인:** 322-354

---

## V1 → V8 변천사

| 버전 | 핵심 전략 | 남은 문제 |
|------|-----------|-----------|
| **V1** | solution_code 제공 | 함수명 언급 |
| **V2** | 나쁜 예시 추가 | 나쁜 예시 복사 |
| **V3** | 나쁜 예시 제거 | 여전히 예시 의존 |
| **V4** | 질문 방식 예시 | 예시 복사 |
| **V5** | 모든 예시 제거 | 프롬프트 복잡 |
| **V6** | 초간단 명령 | 막연한 질문 |
| **V7** | 대조 학습 (구체적 숫자) | 개념 질문 생성 |
| **V8** | 개념 질문 명시적 차단 | ✅ 상황 중심 예상 |

---

## 핵심 교훈

### 프롬프트 엔지니어링의 3단계

**1. 예시 제공 (V1-V4)** → 모델이 복사
**2. 예시 제거 (V5-V6)** → 모델이 막연하게 생성
**3. 대조 학습 (V7)** → 모델이 원칙 이해하지만 여전히 추상적
**4. 명시적 차단 + 대조 (V8)** → ✅ 나쁜 패턴 직접 예시로 차단

### "하지 마"를 어떻게 말하는가

- ❌ **V5**: "구체적 이름 금지" (추상적)
- ❌ **V6**: "함수명 금지" (범주적)
- ✅ **V8**: "함수가 뭐야?"라고 묻지 마 (구체적 예시)

**원칙:** 모델에게 **나쁜 출력의 구체적 예시**를 직접 보여줘야 제대로 차단됨

---

## 테스트 필요

### 검증 포인트

**1. 개념 질문 차단**
- "함수가 뭐야?", "반복문이 뭐야?" 생성 안 됨

**2. 교육적 표현 차단**
- "중요한 단계", "핵심 개념", "이해하기" 사용 안 됨

**3. 상황 중심 질문**
- "10개 처리해야 하는데...", "나중에 바꾸면..." 형태

**4. 물음표 필수**
- 모든 힌트가 `?`로 끝남

---

**작성일:** 2025-01-30
**버전:** V8 (최종)
**이전 버전:** [PROMPT_FIX_V7.md](PROMPT_FIX_V7.md)
