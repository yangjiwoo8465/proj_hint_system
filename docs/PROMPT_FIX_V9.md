# 프롬프트 수정 V9 - Logic Step 기반 소크라테스 학습법

## 문제 상황 (V8 → V9)

### V8의 치명적 결함

**사용자의 핵심 요구사항:**
> "힌트는 해당 문제의 해답 코드를 N개의 Logic으로 분할한 후,
> - 사용자가 M번째 Logic을 틀릴 경우 → M번째 Logic을 풀어낼 수 있는 형태
> - 사용자가 M번째까지 완벽하고 M+1번째를 모르는 경우 → M+1번째 Logic을 떠올릴 수 있는 형태
> - 소크라테스 학습법으로 사용자가 직접 생각할 수 있도록"

**V8 프롬프트의 문제:**
```python
# V8 프롬프트
임무: 학생이 지금 코드로는 "{next_step_goal}"를 할 수 없다는 걸 깨닫게 만드는 질문
```

❌ **Logic Step 컨텍스트 없음:**
- "해답 코드가 N개 Logic으로 나뉜다" → 언급 없음
- "학생이 M번째까지 완료했다" → 언급 없음
- "M+1번째 Logic을 떠올려야 한다" → 막연한 "next_step_goal"만

❌ **소크라테스 학습법의 진짜 의미 누락:**
- 학생이 **어떤 단계**에 있는지 모델이 모름
- **다음 단계가 왜 필요한지** 컨텍스트 부족
- 단순히 "불가능하다"만 제시 → Logic 흐름 없음

---

## 핵심 수정 사항

### V8 프롬프트 (Before)

```python
학생 코드:
{user_code}

학생이 막힌 부분: {next_step_goal}

임무: 학생이 지금 코드로는 "{next_step_goal}"를 할 수 없다는 걸 깨닫게 만드는 질문
```

**문제점:**
1. "막힌 부분"만 제시 → 전체 Logic 흐름 없음
2. M번째 Logic인지, M+1번째 Logic인지 불명확
3. 학생이 어느 단계까지 왔는지 컨텍스트 없음

---

### V9 프롬프트 (After)

```python
상황:
이 문제의 정답 코드는 여러 Logic으로 나뉩니다.
학생은 지금까지 일부 Logic은 구현했지만, "{next_step_goal}"를 아직 구현하지 못했습니다.

학생이 작성한 코드:
{user_code}

다음 단계 (학생이 구현해야 하는 Logic):
{next_step_goal}

임무:
학생의 현재 코드로는 "{next_step_goal}"를 할 수 없다는 것을 깨닫게 만드는 질문을 작성하세요.
학생이 스스로 "{next_step_goal}"의 필요성을 발견하도록 구체적인 상황/불편함을 제시하세요.
```

**개선 사항:**
1. ✅ **Logic Step 명시** - "정답 코드는 여러 Logic으로 나뉩니다"
2. ✅ **현재 위치 명시** - "일부 Logic은 구현했지만"
3. ✅ **다음 단계 명확화** - "다음 단계 (학생이 구현해야 하는 Logic)"
4. ✅ **발견 학습 강조** - "스스로 필요성을 발견하도록"

---

## V9의 새로운 요소

### 1. 상황 설정 (Context)

**V8:**
```
학생이 막힌 부분: {next_step_goal}
```
→ 막연함, 전체 흐름 없음

**V9:**
```
상황:
이 문제의 정답 코드는 여러 Logic으로 나뉩니다.
학생은 지금까지 일부 Logic은 구현했지만, "{next_step_goal}"를 아직 구현하지 못했습니다.
```
→ Logic Step 개념 명시, 진행 상황 제시

---

### 2. 다음 단계 명확화

**V8:**
```
학생이 막힌 부분: {next_step_goal}
```
→ 단순 "막힌 부분"

**V9:**
```
다음 단계 (학생이 구현해야 하는 Logic):
{next_step_goal}
```
→ "다음 단계", "구현해야 하는 Logic" 명시

---

### 3. 발견 학습 강조

**V8:**
```
임무: 학생이 지금 코드로는 "{next_step_goal}"를 할 수 없다는 걸 깨닫게
```
→ 불가능만 제시

**V9:**
```
임무:
학생의 현재 코드로는 "{next_step_goal}"를 할 수 없다는 것을 깨닫게 만드는 질문을 작성하세요.
학생이 스스로 "{next_step_goal}"의 필요성을 발견하도록 구체적인 상황/불편함을 제시하세요.
```
→ 불가능 + **필요성 발견** (소크라테스 핵심)

---

### 4. 질문 작성 전략 확장

**V9 신규 추가:**
```python
질문 작성 전략 (소크라테스 학습법):
1. 현재 코드의 한계: 지금 코드로는 어떤 상황을 처리 못하는지
2. 구체적 숫자 사용: "여러 개"(X) → "10개", "100번", "1000줄"(O)
3. 직접적 불편 제시: "좋은 방법은?"(X) → "너는 매번 손으로 할 건데?"(O)
4. 확장 상황 제시: "입력이 2개가 아니라 100개면?", "문제가 바뀌면 또 처음부터?"
```

**4번 신규 전략:**
- "확장 상황 제시" → M번째까지 완료, M+1번째 필요성 유도
- 구체적 예시: "입력이 2개가 아니라 100개면?"

---

### 5. 금지 사항 강화

**V9 신규 추가:**
```python
- "{next_step_goal}" 내용을 직접 말하지 말고 상황으로 유도
```

**의미:**
- next_step_goal = "반복문 사용"
- ❌ 나쁜 질문: "반복문을 쓰면 어떨까?"
- ✅ 좋은 질문: "입력 10개를 처리하려면 코드 10번 복사?"

---

## V8 vs V9 비교

### 구조 비교

| 항목 | V8 | V9 |
|------|----|----|
| **Logic Step 명시** | ❌ 없음 | ✅ "여러 Logic으로 나뉩니다" |
| **진행 상황** | ❌ 없음 | ✅ "일부 Logic은 구현했지만" |
| **다음 단계 명확성** | "막힌 부분" | "다음 단계 (구현해야 하는 Logic)" |
| **발견 학습** | "깨닫게" | "스스로 필요성을 발견하도록" |
| **확장 상황 전략** | ❌ 없음 | ✅ "입력 100개면?", "문제 바뀌면?" |

---

### 프롬프트 길이 비교

**V8:** 약 25줄
**V9:** 약 45줄

**왜 길어졌나?**
- Logic Step 컨텍스트 추가
- 소크라테스 학습법 명시적 설명
- 확장 상황 전략 추가
- next_step_goal 직접 언급 금지 규칙

---

## 사용자 요구사항 충족 여부

### ✅ 1. N개 Logic 분할 명시

**요구:**
> "해답 코드를 N개의 Logic으로 분할한 후"

**V9 대응:**
```
상황:
이 문제의 정답 코드는 여러 Logic으로 나뉩니다.
```

---

### ✅ 2. M번째 Logic 틀린 경우

**요구:**
> "사용자가 M번째 Logic을 틀릴 경우 → M번째 Logic을 풀어낼 수 있는 형태"

**V9 대응:**
```
학생의 현재 코드로는 "{next_step_goal}"를 할 수 없다는 것을 깨닫게
```
→ M번째 Logic의 문제점을 상황으로 제시

---

### ✅ 3. M+1번째 Logic 모르는 경우

**요구:**
> "M번째까지 완벽하고 M+1번째를 모르는 경우 → M+1번째 Logic을 떠올릴 수 있는 형태"

**V9 대응:**
```
학생은 지금까지 일부 Logic은 구현했지만, "{next_step_goal}"를 아직 구현하지 못했습니다.

질문 작성 전략:
4. 확장 상황 제시: "입력이 2개가 아니라 100개면?", "문제가 바뀌면 또 처음부터?"
```
→ M번째까지 완료 명시 + 확장 상황으로 M+1번째 유도

---

### ✅ 4. 소크라테스 학습법

**요구:**
> "답을 알려주는 형태가 아니라 소크라테스 학습법으로 사용자가 직접 생각할 수 있도록"

**V9 대응:**
```
학생이 스스로 "{next_step_goal}"의 필요성을 발견하도록 구체적인 상황/불편함을 제시하세요.

질문 작성 전략 (소크라테스 학습법):
1. 현재 코드의 한계
2. 구체적 숫자 사용
3. 직접적 불편 제시
4. 확장 상황 제시
```
→ "스스로 발견" + "소크라테스 학습법" 명시

---

## 예상 효과

### V8로 생성될 수 있었던 힌트

```
함수 정의를 이해하는 중요한 단계가 뭘까?
```
→ 교육적, 개념적

```
코드를 더 효율적으로 만들려면?
```
→ 추상적, 막연함

---

### V9로 기대되는 힌트

**상황 1: 반복문 필요 (M+1번째 Logic)**
```
입력이 2개가 아니라 100개면 어떻게 처리할 건데?
```

**상황 2: 함수 필요 (M+1번째 Logic)**
```
같은 계산을 10군데에서 해야 하는데 코드 10번 복사할 건가?
```

**상황 3: 조건문 누락 (M번째 Logic 틀림)**
```
음수가 들어오면 어떻게 되는데?
```

---

## Logic Step 시스템과의 연결

### 시스템 동작 방식

1. **Logic 분할** - 정답 코드를 N개 Logic으로 나눔
   - Logic 1: 입력 받기
   - Logic 2: 반복문으로 처리
   - Logic 3: 조건 검사
   - Logic 4: 결과 출력

2. **학생 코드 분석** - 어느 Logic까지 완료했는지 판단
   - Logic 1 완료 ✅
   - Logic 2 누락 ❌ ← M+1번째

3. **힌트 생성** - M+1번째 Logic 필요성 유도
   - V9 프롬프트: "일부 Logic은 구현했지만, 'Logic 2'를 구현하지 못했습니다"
   - 모델: "입력 100개면 어떻게 처리할 건데?" (반복문 필요성 유도)

---

## V1 → V9 전체 변천사

| 버전 | 핵심 전략 | Logic Step 지원 | 남은 문제 |
|------|-----------|-----------------|-----------|
| **V1-V4** | 예시 제공 | ❌ | 예시 복사 |
| **V5** | 예시 제거 | ❌ | 프롬프트 복잡 |
| **V6** | 초간단 명령 | ❌ | 막연한 질문 |
| **V7** | 대조 학습 | ❌ | 여전히 추상적 |
| **V8** | 개념 질문 차단 | ❌ | **Logic Step 없음** |
| **V9** | Logic Step 기반 | ✅ | 테스트 필요 |

---

## 핵심 개선 요약

### V8의 한계
```python
# 컨텍스트 부족
학생이 막힌 부분: {next_step_goal}

# 막연한 임무
임무: "{next_step_goal}"를 할 수 없다는 걸 깨닫게
```

### V9의 해결
```python
# 풍부한 컨텍스트
상황: 정답 코드는 여러 Logic으로 나뉩니다.
학생은 일부 Logic은 구현했지만, "{next_step_goal}"를 구현하지 못했습니다.
다음 단계 (학생이 구현해야 하는 Logic): {next_step_goal}

# 명확한 임무 + 발견 학습
학생이 스스로 "{next_step_goal}"의 필요성을 발견하도록 상황/불편함을 제시
```

---

## 변경 위치

**파일:** [hint-system/app.py](../hint-system/app.py#L322-L369)
**함수:** `_create_analysis_prompt()`
**라인:** 322-369

---

## 테스트 필요 사항

### 검증 포인트

1. **Logic Step 이해도**
   - 모델이 "여러 Logic으로 나뉜다" 이해하는지
   - "일부 구현, 일부 미구현" 컨텍스트 활용하는지

2. **M+1번째 Logic 유도**
   - 확장 상황 제시: "입력 100개면?"
   - 불편함 제시: "10군데 복사?"

3. **개념 질문 차단 유지**
   - "함수가 뭐야?" 여전히 차단되는지
   - "중요한 단계" 같은 교육적 표현 차단되는지

4. **상황 기반 질문**
   - 구체적 숫자 사용
   - 직접적 불편 제시
   - next_step_goal 직접 언급 회피

---

**작성일:** 2025-01-30
**버전:** V9 (Logic Step 기반)
**이전 버전:** [PROMPT_FIX_V8.md](PROMPT_FIX_V8.md)
**핵심 개선:** 사용자 요구사항 (Logic Step 기반 소크라테스 학습법) 완전 반영
